---
title: 微信开发常见问题
abbrlink: aa15af79
date: 2015-07-29 23:42:15
tags:
  - 微信公众号
  - wechat
  - 网页授权
  - jssdk
categories:
  - PHP
  - ThinkPHP
---

#### 1. JSSDK配置 ####
>不需要填写http://
{% asset_img 1.png 填写开发资料 %}
#### 2. 网页授权配置 ####
```javascript
<SCRIPT type="text/javascript">
 //获取TIKETurl一定位全URL，包括HTTP://
    var url = 'http://ansuns.sinaapp.com/index.php?m=Home&c=Index&a=jssdk;'
</SCRIPT>
<SCRIPT type="text/javascript">
    //引号''不能少
    wx.config({
        debug: false,
        appId: 'wxf732bcda33f3fdac',
        timestamp: 1438184768,
        nonceStr: 'zRcnANUEK8i1hv8q',
        signature: 'bb3df0fb19712b41e308004dd770028f814c1281',
        jsApiList: ['onMenuShareTimeline']
    });
</SCRIPT>
```
>网页授权
{% asset_img 2.png 填写开发资料 %}
#### 3. 获取微信远程图片，避免微信过滤掉外链资源 ####
```php
function replace($str)
{
    preg_match_all("/<img(.*)(src=\"[^\"]+\")[^>]+>/isU", $str, $arr);
    for ($i = 0, $j = count($arr[0]); $i < $j; $i++) {
        $img[$i]['img'] = str_replace('/mobile/', '', str_replace('src=', '', str_replace('"', '', $arr[2][$i])));
        if (strpos('mmbiz', $img[$i]['img']) || strpos('qpic', $img[$i]['img'])) {
            $str = str_replace($arr[0][$i], '<img src="' . $img[$i]['img'] . '" >', $str);
        } else {
            $rs[$i] = $this->weObj->uploadImg(array(
                'media' => '@' . ROOT_PATH . $img[$i]['img']
            ), 'image');
            $str = str_replace($arr[0][$i], '<img src="' . $rs[$i]['url'] . '" >', $str);
        }

    }
    return $str;
}
```